To Do for ASF Stats
===================

- Add to pen names help text: examples of issues where one author
  has two stories, one under a pen name.

- Add more pen names, e.g., Philip St. John for Lester del Rey

- Investigate using the pen names data from ISFDB

- Contact Andrew May at admin@Andrew-May.com, ask for his
  comments on the app.

- Add to ASFcsvFromHtml.py: regenerate the pivot table.

- Write instructions for generating and uploading a new version
  of the data (some or all, e.g. could just be updating pennames
  or might include all the story data).

- Refactor read_df_from_csv()

- Check chat for other display option ideas
  . The chat now includes the agent's code for showing cumulative
    number of stories by an author, try that as a new display option.

 - New displays to add:
	- All one-story authors.
	- Yr/mo of first appearance of each author (and last?)
	- Table of authors with data, e.g.:
	  . birth & death years and places
	  . brief bio, or link to it
	  . links to detailed online info (wikipedia, etc.)

- When downloading a spreadsheet, if it has been filtered (e.g. stories
  for just one author are being displayed) download just the filtered rows.

- Add 1st, last year to heading of plot of stories by one author.

- In Author Totals table, make the columns more narrow.

- In Authors by month table, make the author column wider.

- Consider finding a way to recognize serials as one story.

- Add some sort of contact-me feature for people to
  ask questions, make suggestions, report errors.
  link to ChatGPT discussion about how to send an email from
  python/streamlit:
  https://chatgpt.com/share/696a411f-bed4-8004-9022-ad66ab2b0c65
  Or maybe use a free mailing list product like this:
  https://www.mailersend.com/pricing?_gl=1*1ngklod*_up*MQ..*_gs*MQ..&gclid=CjwKCAiA4KfLBhB0EiwAUY7GAVRqKNN5fq_rugOqXRb4TH-bTm6ljac7EcSqx6a9tF80u59abbUYGRoCmDMQAvD_BwE&gbraid=0AAAAAB2b0e8AX0N3pCX56JGIHfO5awN9m
  Or maybe don't send emails, but just write contact-us data to a db that I manually check?
  https://www.google.com/search?q=write+to+mysql+from+streamlit&client=safari&hs=qGq9&sca_esv=8d8a6070b8a2d493&sxsrf=ANbL-n4b2HXqvUKXqTnGBW1lg7xPRQ1ssA%3A1768571793868&source=hp&ei=kUNqabj-MtXU5NoPzv7E6A0&iflsig=AFdpzrgAAAAAaWpRoVdBVl2ebD6ADGLqJNExBovraUjs&oq=write+to+mysql+from+stre&gs_lp=Egdnd3Mtd2l6Ihh3cml0ZSB0byBteXNxbCBmcm9tIHN0cmUqAggAMgUQIRigATIFECEYoAEyBRAhGKABMgUQIRigAUifVVAAWNZAcAB4AJABAJgBvQGgAb4TqgEEMTYuOLgBAcgBAPgBAZgCGKAC3BTCAgoQIxiABBgnGIoFwgILEAAYgAQYkQIYigXCAgsQABiABBixAxiDAcICDhAuGIAEGLEDGNEDGMcBwgILEC4YgAQYsQMYgwHCAhEQABiABBixAxiDARiKBRiNBsICBRAAGIAEwgIIEC4YgAQYsQPCAg4QLhiABBixAxiDARiKBcICCBAAGIAEGLEDwgIOEC4YgAQYsQMYxwEYrwHCAgUQLhiABMICDRAAGIAEGLEDGIMBGArCAgsQLhiABBjRAxjHAcICBhAAGBYYHsICCBAAGKIEGIkFwgIIEAAYgAQYogTCAgUQIRirApgDAJIHBTExLjEzoAebrQGyBwUxMS4xM7gH3BTCBwgwLjUuMTQuNcgHc4AIAA&sclient=gws-wiz

=============================================================
						D O N E
=============================================================

√ For pdfs:
  √ If file exists on brucewatkins.org, use it
    √ else use the luminist url

√ When a single issue is displayed, provide a link to the pdf 
  of the issue.
  . The pdf files are stored at urls like this:
    https://s3.us-west-1.wasabisys.com/luminist/SF/AST/AST_1946_02.pdf
    https://s3.us-west-1.wasabisys.com/luminist/SF/AST/AST_1960_05.pdf
    https://s3.us-west-1.wasabisys.com/luminist/SF/AN/AN_1960_09.pdf

  . Actually, the Mac Preview app does an excellent job of saving
    a pdf at a reduced size... first couple tried yielded a savings
    of nearly 50% with no visual degradation.

  1 √ Write a script that downloads all the pdfs in our date range
  2 √ Write a script that reduces the size of all the downloaded pdfs
  3 Create a new online subdirectory (pdfs) under the data directory
  4 ... FTP all the reduced size pdfs to the new sub directory
  5 √ Add a link (button?) on the one-page listing for downloading
    that issue's pdf
  6 √ Add a link (button?) on the one-page listing for showing the
    full-sized cover page image (in a new browser tab).

√ Provide (where?) a link to view full-sized cover image(s).

  √ The sizes of the downloaded files vary. Choose a standard
    size that is good for screen viewing, then write a script
    that resizes them all to that standard size.
    600px wide looks like a good size

  √ For any cover image that is larger than 600px wide, reduce
    it to 600px wide, maintaining the ratio.
    √ put the new versions of the jpg files (with the same names)
      into a new directory (locally)

  √ Decide if those with width less than 600px should be resized
    to be 600px wide. YES

  √ Write a script to download all (in our range) full sized
    cover images.

  . They are at urls like this:
    https://luminist.org/archives/SF/AST/AST_1939_07_L.jpg
    https://luminist.org/archives/SF/AN/AN_1960_09_L.jpg

  √ Put them into /data/covers/

√ When a single issue is displayed, show a thumbnail of the cover.
  √ Grab all the thumbnails and store them in the brucewatkins.org
    domain. The images are at, for example, these urls:
    https://luminist.org/archives/SF/AST/AST_1939_08.jpg
    so the file names are ASF_yyyy_mm.jpg

 √ Add a display: show stories from a single issue
  √ Choose from (may two - one month, one year) menu, then
    display the stories in that issue. Or maybe one menu with, e.g.,
    1939 September
    1939 October
    ...
  √ Add heading: Stories From a Single Issue
  √ Include yr,mo in dl csv file name

√ Expand the text above the listing of stories published under
   pen names:

    NN authors published a total of MM stories (shown below) under 
    pen names. 

    Some authors always wrote using a name different from their own 
    (e.g. Lester del Rey was really Leonard Knapp), and in those cases 
    we've decided to say that the commonly known name (e.g. del Rey) is 
    the author's name, not a pen name.

    This approach to which name is the author's "real" name is reasonable
    in most cases, but does lead to at least one unusual result: we don't 
    consider Murray Leinster to be a pen name, but then the one story published 
    under his real name (Will Jenkins) shows up in the listing of pen name stories.

√ Add display option(s):
  √ number of stories published under pen names,
  √ table of stories published under a pen name.

√ Change the way in which author names are handled:
  √ Instead of ending up with columns PubAs and Author,
    we want to have Author and WritingAs.
  √ So no more data in first, last format.
  √ Author willl be in last, first, with spelling changes 
    having been applied.
  x WritingAs will be empty unless the story was 
    published under a pen name.
  . This will make it easy to select and display all
    stories published under pen names.

√ Use the html_from_file function for the help text for
  single author plot and also for multiple author plot.
  √ Create singlehelp.html
  √ Create multhelp.html

√ Change the pen names logic: read from the pen names csv

√ When creating large strings of HTML to display, change the
  code to read that text from a file. Use the .format() method
  to substitute run time string values (e.g. number of stories).
  This way we can change the output text without changing and
  pushing the code.
  Use the * operator, e.g.:
   fruits = ['apple', 'banana', 'cherry']
   message = "I have a {}, a {}, and a {}.".format(*fruits)

√ Figure out why total # stories by van Vogt has different
  values locally/in cloud (58/59)

  √ Pen names to handle: 
	. Wesley Long is a pen name for George O. Smith. 
  	  There are 6 stories by Long (in 44 and 45).
  	. One author appears with two different name spellings:
  	  Coppel, Alfred & Coppel, Alfred, Jr.
  	. John Pierce; John R. Pierce; J. J. Coupling
  	. John Alvarez = Lester del Rey
    . Poul Anderson's pen names

√ Move images to a directory on my domain:
  https://brucewatkins.org/sciencefiction/data/AN196009.thumb.jpg
  https://brucewatkins.org/sciencefiction/data/ASF193907.thumb.jpg

√ Create a script to regenerate the all-stories input csv files
  x Download a copy of A. May's web page, host it on my domain.
  	x has been downloaded to Documents/programming/afstats/origpage.html
  	  (download script is grabpage.py in that directory)
  	x and has been uploaded to 
  	  https://brucewatkins.org/sciencefiction/data/origpage.html

  √ Create a spreadsheet of pen names, save as csv
    . building it as pennames.numbers in Documents/programming/afstats
    
      NOTE: need to distinguish between pen names and simple replacement
      of an author's name because of multiple spellings.

      e.g. Fyfe, Horace B. is not a pen name of Fyfe, H. B, it's just
      a different spelling that needs to be transformed into the 
      "standard" spelling of that author's name. Should not be considered
      a pen name.

      So, we need a separate dataframe of pen names, from which we can
      display "report(s)" about pen names.
      √ Create a spreadsheet of pen names only as pennames.numbers
      √ Create a spreadsheet of spelling "corrections" to be applied
        as spellings.numbers.

√ Expand README.md

√ For horizontal bar chart: is now for top 20 authors.
  Make it variable: choose number, with 20 as the default.

√ Turn grid on for stacked bar chart.

√ Change stacked bar chart: ask for number of authors to
  show (now uses top 10)

√ Multi author plot:
	√ create fcn to display dl button
	√ add download button
	√ add startup text for multiplot, with 3-author sample output

√ Implement the select authors option.
  Start with the code in ASFcompareAuthors.py

√ Add an "about" option that re-displays the start-up page.

√ Add heading to each display option (because there is no
generic heading being displayed now).

√ In plot-one-author, change the heading text style to the
same used for the start-of-app about text.

√ On startup, don't show full listing. Instead, show
	detailed about text, explaining where the data came
	from, how to use the interactive DataTables output,
	etc. Do this as html code.

√ When plot 1 author is chosen, but before an author
has been picked, show the existing text, but expand it
in general, and in particular, display an example plot,
maybe for Heinlein.

√ Deploy 1st version
  √ Push current code to github
  √ Test the deployed version

√ Read the two csv files from urls instead of from local files
  (and instead of using AWS storage).

√ pen names to process:
	Will F. Jenkins = Murray Leinster
	long list of SF pen names:
	https://en.wikipedia.org/wiki/List_of_science-fiction_authors
	this might be a larger list:
	http://www.scifi.darkroastedblend.com/2007/08/authors-pseudonyms.html
	The routine that creates the allStories csv (and handles pen names):

√ In csv dl: author counts needs to be sorted desc on count
  (same for counts by author/year)
  Maybe stop telling DataTables to sort the data, and just
  sort it while still as a dataframe?

√ Provide download button for tables.

√ For plot by year, one author:
  √ Make all years appear, including when there are zero stories
  √ When no author has been chosen, display a help message.
  √ Eliminate the duplicates in the list: should just
  	be a list of the unique author names (right now has
  	one item for every story)
  √ Ask for the author to use
    √ Show full list as a drop down menu?
  √ Provide a button for downloading the plot to a PDF file

√ Implement top 20 authors.

√ When page first appears, show the full list (before any option
  is chosen).

√ Add a title with stats: # stories, # authors, # issues

√ Implement by year, one author.

√ Try (again) generating the pivot table from the all-stories
  table, instead of reading the pivot csv file. 
  => Didn't work... leaving it as is (reading the file)

√ Implement stacked bar chart.

√ First version: local only
	√ Read the csv from a local file
	√ Extract some/all of the analysis code used in the earlier project.
	√ In the left-side panel, drop down menu:
		- Table: Full listing
		- Table: Author counts
		- Table: Author pivot
		- Plot: Stacked bar chart
		- Plot: By Year, 1 Author
		- Plot: Select authors
		- Plot: Top 20 by year
	√ Make the tables sortable and searchable

